{
  "version": 3,
  "sources": ["../../../../../apps/frappe/frappe/public/js/frappe/form/footer/base_timeline.js", "../../../../../apps/frappe/frappe/desk/page/user_profile/user_profile_controller.js"],
  "sourcesContent": ["// Copyright (c) 2020, Frappe Technologies Pvt. Ltd. and Contributors\n// MIT License. See license.txt\n\nclass BaseTimeline {\n\tconstructor(opts) {\n\t\tObject.assign(this, opts);\n\t\tthis.make();\n\t}\n\n\tmake() {\n\t\tthis.timeline_wrapper = $(`<div class=\"new-timeline\">`);\n\t\tthis.wrapper = this.timeline_wrapper;\n\t\tthis.timeline_items_wrapper = $(`<div class=\"timeline-items\">`);\n\t\tthis.timeline_actions_wrapper = $(`\n\t\t\t<div class=\"timeline-items timeline-actions\">\n\t\t\t\t<div class=\"timeline-item\">\n\t\t\t\t\t<div class=\"timeline-dot\"></div>\n\t\t\t\t\t<div class=\"timeline-content action-buttons\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`);\n\n\t\tthis.timeline_wrapper.append(this.timeline_actions_wrapper);\n\t\tthis.timeline_actions_wrapper.hide();\n\t\tthis.timeline_wrapper.append(this.timeline_items_wrapper);\n\n\t\tthis.parent.replaceWith(this.timeline_wrapper);\n\t\tthis.timeline_items = [];\n\t}\n\n\trefresh() {\n\t\tthis.render_timeline_items();\n\t}\n\n\tadd_action_button(label, action, icon = null, btn_class = null) {\n\t\tlet icon_element = icon ? frappe.utils.icon(icon, \"xs\") : null;\n\t\tthis.timeline_actions_wrapper.show();\n\t\tlet action_btn = $(`<button class=\"btn btn-xs ${btn_class || \"btn-default\"} action-btn\">\n\t\t\t${icon_element}\n\t\t\t${label}\n\t\t</button>`);\n\t\taction_btn.click(action);\n\t\tthis.timeline_actions_wrapper.find(\".action-buttons\").append(action_btn);\n\t\treturn action_btn;\n\t}\n\n\trender_timeline_items() {\n\t\tthis.timeline_items_wrapper.empty();\n\t\tthis.timeline_items = [];\n\t\tthis.doc_info = (this.frm && this.frm.get_docinfo()) || {};\n\t\tlet response = this.prepare_timeline_contents();\n\t\tif (response instanceof Promise) {\n\t\t\tresponse.then(() => {\n\t\t\t\tthis.timeline_items.sort(\n\t\t\t\t\t(item1, item2) => new Date(item2.creation) - new Date(item1.creation)\n\t\t\t\t);\n\t\t\t\tthis.timeline_items.forEach(this.add_timeline_item.bind(this));\n\t\t\t});\n\t\t} else {\n\t\t\tthis.timeline_items.sort(\n\t\t\t\t(item1, item2) => new Date(item2.creation) - new Date(item1.creation)\n\t\t\t);\n\t\t\tthis.timeline_items.forEach(this.add_timeline_item.bind(this));\n\t\t}\n\t}\n\n\tprepare_timeline_contents() {\n\t\t//\n\t}\n\n\tadd_timeline_item(item, append_at_the_end = false) {\n\t\tlet timeline_item = this.get_timeline_item(item);\n\t\tif (append_at_the_end) {\n\t\t\tthis.timeline_items_wrapper.append(timeline_item);\n\t\t} else {\n\t\t\tthis.timeline_items_wrapper.prepend(timeline_item);\n\t\t}\n\t\treturn timeline_item;\n\t}\n\n\tadd_timeline_items(items, append_at_the_end = false) {\n\t\titems.forEach((item) => this.add_timeline_item(item, append_at_the_end));\n\t}\n\n\tget_timeline_item(item) {\n\t\t// item can have content*, creation*,\n\t\t// timeline_badge, icon, icon_size,\n\t\t// hide_timestamp, is_card\n\t\tconst timeline_item = $(`<div class=\"timeline-item\">`);\n\t\ttimeline_item.attr({\n\t\t\t\"data-doctype\": item.doctype,\n\t\t\t\"data-name\": item.name,\n\t\t});\n\t\tif (item.icon) {\n\t\t\ttimeline_item.append(`\n\t\t\t\t<div class=\"timeline-badge\" title='${item.title || frappe.utils.to_title_case(item.icon)}'>\n\t\t\t\t\t${frappe.utils.icon(item.icon, item.icon_size || \"md\")}\n\t\t\t\t</div>\n\t\t\t`);\n\t\t} else if (item.timeline_badge) {\n\t\t\ttimeline_item.append(item.timeline_badge);\n\t\t} else {\n\t\t\ttimeline_item.append(`<div class=\"timeline-dot\">`);\n\t\t}\n\n\t\ttimeline_item.append(\n\t\t\t`<div class=\"timeline-content ${item.is_card ? \"frappe-card\" : \"\"}\">`\n\t\t);\n\t\tlet timeline_content = timeline_item.find(\".timeline-content\");\n\t\ttimeline_content.append(item.content);\n\t\tif (!item.hide_timestamp && !item.is_card) {\n\t\t\ttimeline_content.append(`<span> - ${comment_when(item.creation)}</span>`);\n\t\t}\n\t\tif (item.id) {\n\t\t\ttimeline_content.attr(\"id\", item.id);\n\t\t}\n\t\treturn timeline_item;\n\t}\n}\n\nexport default BaseTimeline;\n", "import BaseTimeline from \"../../../public/js/frappe/form/footer/base_timeline\";\nfrappe.provide(\"frappe.energy_points\");\n\nclass UserProfile {\n\tconstructor(wrapper) {\n\t\tthis.wrapper = $(wrapper);\n\t\tthis.page = frappe.ui.make_app_page({\n\t\t\tparent: wrapper,\n\t\t});\n\t\tthis.sidebar = this.wrapper.find(\".layout-side-section\");\n\t\tthis.main_section = this.wrapper.find(\".layout-main-section\");\n\t\tthis.wrapper.bind(\"show\", () => {\n\t\t\tthis.show();\n\t\t});\n\t}\n\n\tshow() {\n\t\tlet route = frappe.get_route();\n\t\tthis.user_id = route[1] || frappe.session.user;\n\t\tfrappe.dom.freeze(__(\"Loading user profile\") + \"...\");\n\t\tfrappe.db.exists(\"User\", this.user_id).then((exists) => {\n\t\t\tfrappe.dom.unfreeze();\n\t\t\tif (exists) {\n\t\t\t\tthis.make_user_profile();\n\t\t\t} else {\n\t\t\t\tfrappe.msgprint(__(\"User does not exist\"));\n\t\t\t}\n\t\t});\n\t}\n\n\tmake_user_profile() {\n\t\tthis.user = frappe.user_info(this.user_id);\n\t\tthis.page.set_title(this.user.fullname);\n\t\tthis.setup_user_search();\n\t\tthis.main_section.empty().append(frappe.render_template(\"user_profile\"));\n\t\tthis.energy_points = 0;\n\t\tthis.review_points = 0;\n\t\tthis.rank = 0;\n\t\tthis.month_rank = 0;\n\t\tthis.render_user_details();\n\t\tthis.render_points_and_rank();\n\t\tthis.render_heatmap();\n\t\tthis.render_line_chart();\n\t\tthis.render_percentage_chart(\"type\", \"Type Distribution\");\n\t\tthis.create_percentage_chart_filters();\n\t\tthis.setup_user_activity_timeline();\n\t}\n\n\tsetup_user_search() {\n\t\tthis.$user_search_button = this.page.set_secondary_action(\n\t\t\t__(\"Change User\"),\n\t\t\t() => this.show_user_search_dialog(),\n\t\t\t{ icon: \"change\", size: \"sm\" }\n\t\t);\n\t}\n\n\tshow_user_search_dialog() {\n\t\tlet dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Change User\"),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Link\",\n\t\t\t\t\tfieldname: \"user\",\n\t\t\t\t\toptions: \"User\",\n\t\t\t\t\tlabel: __(\"User\"),\n\t\t\t\t},\n\t\t\t],\n\t\t\tprimary_action_label: __(\"Go\"),\n\t\t\tprimary_action: ({ user }) => {\n\t\t\t\tdialog.hide();\n\t\t\t\tfrappe.set_route(\"user-profile\", user);\n\t\t\t},\n\t\t});\n\t\tdialog.show();\n\t}\n\n\trender_heatmap() {\n\t\tthis.heatmap = new frappe.Chart(\".performance-heatmap\", {\n\t\t\ttype: \"heatmap\",\n\t\t\tcountLabel: \"Energy Points\",\n\t\t\tdata: {},\n\t\t\tdiscreteDomains: 1,\n\t\t\tradius: 3,\n\t\t\theight: 150,\n\t\t});\n\t\tthis.update_heatmap_data();\n\t\tthis.create_heatmap_chart_filters();\n\t}\n\n\tupdate_heatmap_data(date_from) {\n\t\tfrappe\n\t\t\t.xcall(\"frappe.desk.page.user_profile.user_profile.get_energy_points_heatmap_data\", {\n\t\t\t\tuser: this.user_id,\n\t\t\t\tdate: date_from || frappe.datetime.year_start(),\n\t\t\t})\n\t\t\t.then((r) => {\n\t\t\t\tthis.heatmap.update({ dataPoints: r });\n\t\t\t});\n\t}\n\n\trender_line_chart() {\n\t\tthis.line_chart_filters = [\n\t\t\t[\"Energy Point Log\", \"user\", \"=\", this.user_id, false],\n\t\t\t[\"Energy Point Log\", \"type\", \"!=\", \"Review\", false],\n\t\t];\n\n\t\tthis.line_chart_config = {\n\t\t\ttimespan: \"Last Month\",\n\t\t\ttime_interval: \"Daily\",\n\t\t\ttype: \"Line\",\n\t\t\tvalue_based_on: \"points\",\n\t\t\tchart_type: \"Sum\",\n\t\t\tdocument_type: \"Energy Point Log\",\n\t\t\tname: \"Energy Points\",\n\t\t\twidth: \"half\",\n\t\t\tbased_on: \"creation\",\n\t\t};\n\n\t\tthis.line_chart = new frappe.Chart(\".performance-line-chart\", {\n\t\t\ttype: \"line\",\n\t\t\theight: 200,\n\t\t\tdata: {\n\t\t\t\tlabels: [],\n\t\t\t\tdatasets: [{}],\n\t\t\t},\n\t\t\tcolors: [\"purple\"],\n\t\t\taxisOptions: {\n\t\t\t\txIsSeries: 1,\n\t\t\t},\n\t\t});\n\t\tthis.update_line_chart_data();\n\t\tthis.create_line_chart_filters();\n\t}\n\n\tupdate_line_chart_data() {\n\t\tthis.line_chart_config.filters_json = JSON.stringify(this.line_chart_filters);\n\n\t\tfrappe\n\t\t\t.xcall(\"frappe.desk.doctype.dashboard_chart.dashboard_chart.get\", {\n\t\t\t\tchart: this.line_chart_config,\n\t\t\t\tno_cache: 1,\n\t\t\t})\n\t\t\t.then((chart) => {\n\t\t\t\tthis.line_chart.update(chart);\n\t\t\t});\n\t}\n\n\t// eslint-disable-next-line no-unused-vars\n\trender_percentage_chart(field, title) {\n\t\tfrappe\n\t\t\t.xcall(\n\t\t\t\t\"frappe.desk.page.user_profile.user_profile.get_energy_points_percentage_chart_data\",\n\t\t\t\t{\n\t\t\t\t\tuser: this.user_id,\n\t\t\t\t\tfield: field,\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then((chart) => {\n\t\t\t\tif (chart.labels.length) {\n\t\t\t\t\tthis.percentage_chart = new frappe.Chart(\".performance-percentage-chart\", {\n\t\t\t\t\t\ttype: \"percentage\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tlabels: chart.labels,\n\t\t\t\t\t\t\tdatasets: chart.datasets,\n\t\t\t\t\t\t},\n\t\t\t\t\t\ttruncateLegends: 1,\n\t\t\t\t\t\tbarOptions: {\n\t\t\t\t\t\t\theight: 11,\n\t\t\t\t\t\t\tdepth: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t\theight: 200,\n\t\t\t\t\t\tmaxSlices: 8,\n\t\t\t\t\t\tcolors: [\n\t\t\t\t\t\t\t\"purple\",\n\t\t\t\t\t\t\t\"blue\",\n\t\t\t\t\t\t\t\"cyan\",\n\t\t\t\t\t\t\t\"teal\",\n\t\t\t\t\t\t\t\"pink\",\n\t\t\t\t\t\t\t\"red\",\n\t\t\t\t\t\t\t\"orange\",\n\t\t\t\t\t\t\t\"yellow\",\n\t\t\t\t\t\t],\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tthis.wrapper.find(\".percentage-chart-container\").hide();\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tcreate_line_chart_filters() {\n\t\tlet filters = [\n\t\t\t{\n\t\t\t\tlabel: \"All\",\n\t\t\t\toptions: [\"All\", \"Auto\", \"Criticism\", \"Appreciation\", \"Revert\"],\n\t\t\t\taction: (selected_item) => {\n\t\t\t\t\tif (selected_item === \"All\") {\n\t\t\t\t\t\tthis.line_chart_filters = [\n\t\t\t\t\t\t\t[\"Energy Point Log\", \"user\", \"=\", this.user_id, false],\n\t\t\t\t\t\t\t[\"Energy Point Log\", \"type\", \"!=\", \"Review\", false],\n\t\t\t\t\t\t];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.line_chart_filters[1] = [\n\t\t\t\t\t\t\t\"Energy Point Log\",\n\t\t\t\t\t\t\t\"type\",\n\t\t\t\t\t\t\t\"=\",\n\t\t\t\t\t\t\tselected_item,\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t];\n\t\t\t\t\t}\n\t\t\t\t\tthis.update_line_chart_data();\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"Last Month\",\n\t\t\t\toptions: [\"Last Week\", \"Last Month\", \"Last Quarter\", \"Last Year\"],\n\t\t\t\taction: (selected_item) => {\n\t\t\t\t\tthis.line_chart_config.timespan = selected_item;\n\t\t\t\t\tthis.update_line_chart_data();\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"Daily\",\n\t\t\t\toptions: [\"Daily\", \"Weekly\", \"Monthly\"],\n\t\t\t\taction: (selected_item) => {\n\t\t\t\t\tthis.line_chart_config.time_interval = selected_item;\n\t\t\t\t\tthis.update_line_chart_data();\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t\tfrappe.dashboard_utils.render_chart_filters(\n\t\t\tfilters,\n\t\t\t\"chart-filter\",\n\t\t\t\".line-chart-options\",\n\t\t\t1\n\t\t);\n\t}\n\n\tcreate_percentage_chart_filters() {\n\t\tlet filters = [\n\t\t\t{\n\t\t\t\tlabel: \"Type\",\n\t\t\t\toptions: [\"Type\", \"Reference Doctype\", \"Rule\"],\n\t\t\t\tfieldnames: [\"type\", \"reference_doctype\", \"rule\"],\n\t\t\t\taction: (selected_item, fieldname) => {\n\t\t\t\t\tlet title = selected_item + \" Distribution\";\n\t\t\t\t\tthis.render_percentage_chart(fieldname, title);\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t\tfrappe.dashboard_utils.render_chart_filters(\n\t\t\tfilters,\n\t\t\t\"chart-filter\",\n\t\t\t\".percentage-chart-options\"\n\t\t);\n\t}\n\n\tcreate_heatmap_chart_filters() {\n\t\tlet filters = [\n\t\t\t{\n\t\t\t\tlabel: frappe.dashboard_utils.get_year(frappe.datetime.now_date()),\n\t\t\t\toptions: frappe.dashboard_utils.get_years_since_creation(\n\t\t\t\t\tfrappe.boot.user.creation\n\t\t\t\t),\n\t\t\t\taction: (selected_item) => {\n\t\t\t\t\tthis.update_heatmap_data(frappe.datetime.obj_to_str(selected_item));\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t\tfrappe.dashboard_utils.render_chart_filters(filters, \"chart-filter\", \".heatmap-options\");\n\t}\n\n\tedit_profile() {\n\t\tlet edit_profile_dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Edit Profile\"),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Attach Image\",\n\t\t\t\t\tfieldname: \"user_image\",\n\t\t\t\t\tlabel: \"Profile Image\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\tfieldname: \"interest\",\n\t\t\t\t\tlabel: \"Interests\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Column Break\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\tfieldname: \"location\",\n\t\t\t\t\tlabel: \"Location\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Section Break\",\n\t\t\t\t\tfieldname: \"Interest\",\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Small Text\",\n\t\t\t\t\tfieldname: \"bio\",\n\t\t\t\t\tlabel: \"Bio\",\n\t\t\t\t},\n\t\t\t],\n\t\t\tprimary_action: (values) => {\n\t\t\t\tedit_profile_dialog.disable_primary_action();\n\t\t\t\tfrappe\n\t\t\t\t\t.xcall(\"frappe.desk.page.user_profile.user_profile.update_profile_info\", {\n\t\t\t\t\t\tprofile_info: values,\n\t\t\t\t\t})\n\t\t\t\t\t.then((user) => {\n\t\t\t\t\t\tuser.image = user.user_image;\n\t\t\t\t\t\tthis.user = Object.assign(values, user);\n\t\t\t\t\t\tedit_profile_dialog.hide();\n\t\t\t\t\t\tthis.render_user_details();\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tedit_profile_dialog.enable_primary_action();\n\t\t\t\t\t});\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Save\"),\n\t\t});\n\n\t\tedit_profile_dialog.set_values({\n\t\t\tuser_image: this.user.image,\n\t\t\tlocation: this.user.location,\n\t\t\tinterest: this.user.interest,\n\t\t\tbio: this.user.bio,\n\t\t});\n\t\tedit_profile_dialog.show();\n\t}\n\n\trender_user_details() {\n\t\tthis.sidebar.empty().append(\n\t\t\tfrappe.render_template(\"user_profile_sidebar\", {\n\t\t\t\tuser_image: this.user.image,\n\t\t\t\tuser_abbr: this.user.abbr,\n\t\t\t\tuser_location: this.user.location,\n\t\t\t\tuser_interest: this.user.interest,\n\t\t\t\tuser_bio: this.user.bio,\n\t\t\t})\n\t\t);\n\n\t\tthis.setup_user_profile_links();\n\t}\n\n\tsetup_user_profile_links() {\n\t\tif (this.user_id !== frappe.session.user) {\n\t\t\tthis.wrapper.find(\".profile-links\").hide();\n\t\t} else {\n\t\t\tthis.wrapper.find(\".edit-profile-link\").on(\"click\", () => {\n\t\t\t\tthis.edit_profile();\n\t\t\t});\n\n\t\t\tthis.wrapper.find(\".user-settings-link\").on(\"click\", () => {\n\t\t\t\tthis.go_to_user_settings();\n\t\t\t});\n\t\t}\n\t}\n\n\tget_user_rank() {\n\t\treturn frappe\n\t\t\t.xcall(\"frappe.desk.page.user_profile.user_profile.get_user_rank\", {\n\t\t\t\tuser: this.user_id,\n\t\t\t})\n\t\t\t.then((r) => {\n\t\t\t\tif (r.monthly_rank.length) this.month_rank = r.monthly_rank[0];\n\t\t\t\tif (r.all_time_rank.length) this.rank = r.all_time_rank[0];\n\t\t\t});\n\t}\n\n\tget_user_points() {\n\t\treturn frappe\n\t\t\t.xcall(\n\t\t\t\t\"frappe.social.doctype.energy_point_log.energy_point_log.get_user_energy_and_review_points\",\n\t\t\t\t{\n\t\t\t\t\tuser: this.user_id,\n\t\t\t\t}\n\t\t\t)\n\t\t\t.then((r) => {\n\t\t\t\tif (r[this.user_id]) {\n\t\t\t\t\tthis.energy_points = r[this.user_id].energy_points;\n\t\t\t\t\tthis.review_points = r[this.user_id].review_points;\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\trender_points_and_rank() {\n\t\tlet $profile_details = this.wrapper.find(\".user-stats\");\n\t\tlet $profile_details_wrapper = this.wrapper.find(\".user-stats-detail\");\n\n\t\tconst _get_stat_dom = (value, label, icon) => {\n\t\t\treturn `<div class=\"user-stats-item mt-4\">\n\t\t\t\t${frappe.utils.icon(icon, \"lg\", \"no-stroke\")}\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"stat-value\">${value}</div>\n\t\t\t\t\t<div class=\"stat-label\">${label}</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t\t};\n\n\t\tthis.get_user_rank().then(() => {\n\t\t\tthis.get_user_points().then(() => {\n\t\t\t\tlet html = $(`\n\t\t\t\t\t${_get_stat_dom(this.energy_points, __(\"Energy Points\"), \"color-energy-points\")}\n\t\t\t\t\t${_get_stat_dom(this.review_points, __(\"Review Points\"), \"color-review-points\")}\n\t\t\t\t\t${_get_stat_dom(this.rank, __(\"Rank\"), \"color-rank\")}\n\t\t\t\t\t${_get_stat_dom(this.month_rank, __(\"Monthly Rank\"), \"color-monthly-rank\")}\n\t\t\t\t`);\n\n\t\t\t\t$profile_details.append(html);\n\t\t\t\t$profile_details_wrapper.removeClass(\"hide\");\n\t\t\t});\n\t\t});\n\t}\n\n\tgo_to_user_settings() {\n\t\tfrappe.set_route(\"Form\", \"User\", this.user_id);\n\t}\n\n\tsetup_user_activity_timeline() {\n\t\tthis.user_activity_timeline = new UserProfileTimeline({\n\t\t\tparent: this.wrapper.find(\".recent-activity-list\"),\n\t\t\tfooter: this.wrapper.find(\".recent-activity-footer\"),\n\t\t\tuser: this.user_id,\n\t\t});\n\n\t\tthis.user_activity_timeline.refresh();\n\t}\n}\n\nclass UserProfileTimeline extends BaseTimeline {\n\tmake() {\n\t\tsuper.make();\n\t\tthis.activity_start = 0;\n\t\tthis.activity_limit = 20;\n\t\tthis.setup_show_more_activity();\n\t}\n\tprepare_timeline_contents() {\n\t\treturn this.get_user_activity_data().then((activities) => {\n\t\t\tif (!activities.length) {\n\t\t\t\tthis.show_more_button.hide();\n\t\t\t\tthis.timeline_wrapper.html(`<div>${__(\"No activities to show\")}</div>`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.show_more_button.toggle(activities.length === this.activity_limit);\n\t\t\tthis.timeline_items = activities.map((activity) =>\n\t\t\t\tthis.get_activity_timeline_item(activity)\n\t\t\t);\n\t\t});\n\t}\n\n\tget_user_activity_data() {\n\t\treturn frappe.xcall(\"frappe.desk.page.user_profile.user_profile.get_energy_points_list\", {\n\t\t\tstart: this.activity_start,\n\t\t\tlimit: this.activity_limit,\n\t\t\tuser: this.user,\n\t\t});\n\t}\n\n\tget_activity_timeline_item(data) {\n\t\tlet icon =\n\t\t\tdata.type == \"Appreciation\" ? \"clap\" : data.type == \"Criticism\" ? \"criticize\" : null;\n\t\treturn {\n\t\t\ticon: icon,\n\t\t\tcreation: data.creation,\n\t\t\tis_card: true,\n\t\t\tcontent: frappe.energy_points.format_history_log(data),\n\t\t};\n\t}\n\n\tsetup_show_more_activity() {\n\t\tthis.show_more_button = $(\n\t\t\t`<a class=\"show-more-activity-btn\">${__(\"Show More Activity\")}</a>`\n\t\t);\n\t\tthis.show_more_button.hide();\n\t\tthis.footer.append(this.show_more_button);\n\t\tthis.show_more_button.on(\"click\", () => this.show_more_activity());\n\t}\n\n\tshow_more_activity() {\n\t\tthis.activity_start += this.activity_limit;\n\t\tthis.get_user_activity_data().then((activities) => {\n\t\t\tif (!activities.length || activities.length < this.activity_limit) {\n\t\t\t\tthis.show_more_button.hide();\n\t\t\t}\n\t\t\tlet timeline_items = activities.map((activity) =>\n\t\t\t\tthis.get_activity_timeline_item(activity)\n\t\t\t);\n\t\t\ttimeline_items.map((item) => this.add_timeline_item(item, true));\n\t\t});\n\t}\n}\n\nfrappe.provide(\"frappe.ui\");\nfrappe.ui.UserProfile = UserProfile;\n"],
  "mappings": "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",
  "names": []
}
